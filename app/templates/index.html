<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Holover App - Dashboard</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>
<body>
  <header class="app-header">
    <div class="brand">
      <img src="https://upload.wikimedia.org/wikipedia/commons/2/24/Circle-icons-profile.svg" alt="Logo" class="logo"/>
      <h1>Holover App</h1>
    </div>
    <nav class="tabs" role="tablist" aria-label="Main tabs">
      <button class="tab active" data-tab="dashboard" role="tab" aria-selected="true">แดชบอร์ด</button>
      <button class="tab" data-tab="profile" role="tab" aria-selected="false">โปรไฟล์</button>
      <button class="tab" data-tab="content" role="tab" aria-selected="false">คอนเทนต์</button>
    </nav>
  </header>

  <main class="container">
    <!-- Alerts -->
    <div id="alerts" class="alerts" aria-live="polite"></div>

    <!-- Dashboard -->
    <section id="tab-dashboard" class="tab-panel active" role="tabpanel" aria-labelledby="dashboard">
      <div class="card">
        <h2>การตั้งค่าโทเค็น</h2>
        <p>กรอกหรือนำโทเค็นจาก OAuth มาเก็บไว้ในเบราว์เซอร์ของคุณ (localStorage).</p>
        <div class="row">
          <input id="token-input" type="text" placeholder="เช่น dev_access_token หรือโทเค็นจริงของคุณ" />
          <button id="save-token-btn" class="btn primary">บันทึกโทเค็น</button>
          <button id="clear-token-btn" class="btn danger outline">ลบโทเค็น</button>
        </div>
        <small id="token-status" class="muted">สถานะ: ยังไม่มีโทเค็นที่บันทึกไว้</small>
      </div>

      <div class="card">
        <h2>เข้าสู่ระบบผ่าน TikTok OAuth</h2>
        <p>ไปยังหน้าต่างอนุมัติจาก TikTok (dev-mode จะคืนค่าโทเค็นจำลองหลัง callback).</p>
        <div class="row">
          <a href="/auth/login" class="btn">ไปหน้า Login /auth/login</a>
          <a href="/auth/login?force=1&prompt=consent" class="btn warning outline" title="บังคับให้ TikTok แสดงหน้าขออนุมัติใหม่">Login (บังคับขออนุมัติ)</a>
          <button id="client-token-btn" class="btn outline">ขอโทเค็นระดับไคลเอ็นต์</button>
        </div>
        <pre id="client-token-output" class="code"></pre>
      </div>

      <div class="card">
        <h2>เครื่องมือดีบัก</h2>
        <div class="row">
          <button id="display-debug-btn" class="btn outline">เช็ค /display/debug</button>
          <button id="content-debug-btn" class="btn outline">เช็ค /content/debug</button>
        </div>
        <pre id="debug-output" class="code"></pre>
      </div>
    </section>

    <!-- Profile -->
    <section id="tab-profile" class="tab-panel" role="tabpanel" aria-labelledby="profile">
      <div class="card">
        <h2>ข้อมูลผู้ใช้ TikTok</h2>
        <p>ใช้โทเค็นที่บันทึกไว้เพื่อเรียกดูข้อมูลโปรไฟล์.</p>
        <div class="row">
          <button id="fetch-profile-btn" class="btn primary">ดึงโปรไฟล์</button>
          <button id="creator-info-btn" class="btn">ดึงข้อมูลผู้สร้าง</button>
        </div>
        <div id="profile-view" class="profile">
          <div class="profile-basic">
            <img id="profile-image" src="" alt="Profile" class="avatar" hidden />
            <div>
              <div class="label">ชื่อแสดงผล:</div>
              <div id="profile-display-name" class="value">-</div>
              <div class="label">Open ID:</div>
              <div id="profile-open-id" class="value">-</div>
            </div>
          </div>
          <div class="stats">
            <div class="stat">
              <div class="stat-number" id="stat-followers">0</div>
              <div class="stat-label">ผู้ติดตาม</div>
            </div>
            <div class="stat">
              <div class="stat-number" id="stat-following">0</div>
              <div class="stat-label">กำลังติดตาม</div>
            </div>
            <div class="stat">
              <div class="stat-number" id="stat-likes">0</div>
              <div class="stat-label">ยอดถูกใจ</div>
            </div>
            <div class="stat">
              <div class="stat-number" id="stat-videos">0</div>
              <div class="stat-label">จำนวนวิดีโอ</div>
            </div>
          </div>
        </div>
        <pre id="creator-info-output" class="code"></pre>
      </div>
    </section>

    <!-- Content -->
    <section id="tab-content" class="tab-panel" role="tabpanel" aria-labelledby="content">
      <div class="grid">
        <div class="card">
          <h2>อัปโหลดไฟล์</h2>
          <form id="upload-file-form">
            <label for="upload-file-input">เลือกไฟล์วิดีโอ</label>
            <input id="upload-file-input" type="file" accept="video/*" required />
            <label for="upload-file-privacy">โหมดเผยแพร่</label>
            <select id="upload-file-privacy">
              <option value="draft">ร่าง (draft)</option>
              <option value="public">สาธารณะ (public)</option>
              <option value="friends">เพื่อน (friends)</option>
              <option value="self">ส่วนตัว (self)</option>
            </select>
            <button type="submit" class="btn primary">อัปโหลด</button>
          </form>
          <pre id="upload-file-output" class="code"></pre>
        </div>

        <div class="card">
          <h2>อัปโหลดจาก URL</h2>
          <form id="upload-url-form">
            <label for="upload-url-input">ที่อยู่ไฟล์ (ต้องอยู่ในโดเมนที่อนุญาต)</label>
            <input id="upload-url-input" type="url" placeholder="https://example.com/video.mp4" required />
            <label for="upload-url-privacy">โหมดเผยแพร่</label>
            <select id="upload-url-privacy">
              <option value="draft">ร่าง (draft)</option>
              <option value="public">สาธารณะ (public)</option>
              <option value="friends">เพื่อน (friends)</option>
              <option value="self">ส่วนตัว (self)</option>
            </select>
            <button type="submit" class="btn primary">สร้างงานดึงไฟล์</button>
          </form>
          <pre id="upload-url-output" class="code"></pre>
        </div>

        <div class="card">
          <h2>ตรวจสอบสถานะงาน</h2>
          <form id="status-form">
            <label for="status-job-id">รหัสงาน (job_id)</label>
            <input id="status-job-id" type="text" placeholder="ใส่ job_id ที่ได้จากการอัปโหลด" required />
            <button type="submit" class="btn">ตรวจสอบ</button>
          </form>
          <pre id="status-output" class="code"></pre>
        </div>

        <div class="card">
          <h2>เผยแพร่</h2>
          <form id="publish-form">
            <label for="publish-job-id">รหัสงาน (ต้องอยู่สถานะ completed)</label>
            <input id="publish-job-id" type="text" placeholder="job_id" required />
            <label for="publish-privacy">ความเป็นส่วนตัว</label>
            <select id="publish-privacy">
              <option value="draft">ร่าง (draft)</option>
              <option value="public">สาธารณะ (public)</option>
              <option value="friends">เพื่อน (friends)</option>
              <option value="self">ส่วนตัว (self)</option>
            </select>
            <label for="publish-caption">คำบรรยาย (ไม่บังคับ)</label>
            <input id="publish-caption" type="text" placeholder="เขียนคำบรรยาย..." />
            <button type="submit" class="btn success">เผยแพร่</button>
          </form>
          <pre id="publish-output" class="code"></pre>
        </div>
      </div>
    </section>
  </main>

  <footer class="app-footer">
    <div class="muted">© 2025 Holover App</div>
  </footer>

  <script src="/static/app.js" defer></script>
</body>
</html>